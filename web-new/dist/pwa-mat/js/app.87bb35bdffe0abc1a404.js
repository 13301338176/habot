webpackJsonp([2],{"+nwc":function(t,e){},0:function(t,e,i){t.exports=i("nplA")},"3Puz":function(t,e){},"5Tvc":function(t,e){},"7HFs":function(t,e){},KwAo:function(t,e){},MiNd:function(t,e){},N12Q:function(t,e){},QsxH:function(t,e){},R58i:function(t,e){},TqJv:function(t,e){},VRCQ:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("q-toggle",{attrs:{"true-value":"ON","false-value":"OFF"},model:{value:t.itemState,callback:function(e){t.itemState=e},expression:"itemState"}})},o=[];n._withStripped=!0;var a=i("XyMi"),s=!1;var r=function(t){s||i("MiNd")},c=Object(a.a)({props:["model"],computed:{itemState:{get:function(){return this.$store.getters["items/itemState"](this.model.item)},set:function(t){this.$store.dispatch("items/sendCmd",{itemName:this.model.item,command:t})}}}},n,o,!1,r,null,null);c.options.__file="src\\components\\HbSwitch.vue";var l=c.exports,d={props:["model"],components:{HbSwitch:l},data:function(){return{config:this.model.config}},created:function(){},asyncComputed:{label:{get:function(){return this.$expr(this.model.config.label)}},state:{get:function(){return this.$expr(this.model.config.state)}}}},u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-item",{attrs:{separator:"",tag:"label"}},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v(t._s(t.label))]),t._v(" "),t.model.config.item?i("q-item-tile",{staticClass:"item-subtitle",attrs:{sublabel:""}},[t._v(t._s(t.model.config.item))]):t._e()],1),t._v(" "),i("q-item-side",{attrs:{right:""}},[t.model.config.state?i("big",{staticClass:"big-value"},[t._v(t._s(t.state))]):t._e(),t._v(" "),"Switch"===t.model.config.control?i("hb-switch",{attrs:{model:t.model.config}}):t._e()],1)],1)},m=[];u._withStripped=!0;var h=!1;var p=function(t){h||i("7HFs")},f=Object(a.a)(d,u,m,!1,p,"data-v-74c76e7b",null);f.options.__file="src\\components\\HbListItem.vue";var v={components:{HbListItem:f.exports},props:["model"],data:function(){return{}}},g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-list",{attrs:{link:t.model.config.link}},t._l(t.model.slots.items,function(e){return t.model.slots.items?i("hb-list-item",{key:e,attrs:{model:e}}):t._e()}))},b=[];g._withStripped=!0;var _=Object(a.a)(v,g,b,!1,null,null,null);_.options.__file="src\\components\\HbList.vue";var y=_.exports,q={props:["model"],data:function(){return{wait:!1}},computed:{itemState:{get:function(){return this.wait?this.next:parseFloat(this.$store.getters["items/itemState"](this.model.config.item))||0},set:function(t){var e=this;this.next=t,this.wait||(this.wait=!0,this.$store.dispatch("items/sendCmd",{itemName:this.model.config.item,command:t}),setTimeout(function(){e.wait=!1,setTimeout(function(){e.$store.dispatch("items/sendCmd",{itemName:e.model.config.item,command:e.next})})},500))}}}},w=function(){var t=this,e=t.$createElement;return(t._self._c||e)("q-knob",{attrs:{color:t.model.config.color,size:t.model.config.size,min:t.model.config.min,max:t.model.config.max,step:t.model.config.step},model:{value:t.itemState,callback:function(e){t.itemState=e},expression:"itemState"}})},k=[];w._withStripped=!0;var C=!1;var S=function(t){C||i("5Tvc")},x=Object(a.a)(q,w,k,!1,S,null,null);x.options.__file="src\\components\\HbKnob.vue";var $=x.exports,N={props:["model"],data:function(){return{wait:!1}},computed:{itemState:{get:function(){return this.wait?this.next:parseFloat(this.$store.getters["items/itemState"](this.model.config.item))},set:function(t){var e=this;this.next=t,this.wait||(this.wait=!0,this.$store.dispatch("items/sendCmd",{itemName:this.model.config.item,command:t}),setTimeout(function(){e.wait=!1,setTimeout(function(){e.$store.dispatch("items/sendCmd",{itemName:e.model.config.item,command:e.next})})},500))}}}},A=function(){var t=this,e=t.$createElement;return(t._self._c||e)("q-slider",{attrs:{color:t.model.config.color,size:t.model.config.size,min:t.model.config.min,max:t.model.config.max,step:t.model.config.step},model:{value:t.itemState,callback:function(e){t.itemState=e},expression:"itemState"}})},H=[];A._withStripped=!0;var Q=Object(a.a)(N,A,H,!1,null,null,null);Q.options.__file="src\\components\\HbSlider.vue";var O={components:{HbList:y,HbSwitch:l,HbKnob:$,HbSlider:Q.exports},props:["model","menu"],data:function(){return{}},methods:{addCardToDeck:function(){this.$q.notify("Not implemented")},addCardToDeckAndBookmark:function(){this.$q.notify("Not implemented")},bookmarkCard:function(){this.$q.notify("Not implemented")},editCard:function(){this.model.uid&&this.$router.push("/designer/"+this.model.uid)},forceRefresh:function(){this.$forceUpdate()}}},T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-card",{staticClass:"bigger",attrs:{inline:""}},[t.model.imageUri?i("q-card-media",[i("img",{attrs:{src:t.model.imageUri}})]):t._e(),t._v(" "),i("q-card-title",[i("span",[t._v(t._s(t.model.title))]),t._v(" "),t.model.subtitle?i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v(t._s(t.model.subtitle))]):t._e(),t._v(" "),i("div",{attrs:{slot:"right"},slot:"right"},[t._l(t.model.slots.right,function(e){return t.model.slots&&t.model.slots.right?i("div",{key:e,staticClass:"inline-block"},["HbSingleItemValue"==e.component?i("big",{staticClass:"big-value"},[t._v(t._s(e.config.state))]):t._e()],1):t._e()}),t._v(" "),i("q-btn",{attrs:{slot:"right",round:"",flat:"",icon:"more_vert"},slot:"right"},[i("q-popover",[i("q-list",{staticClass:"no-border",attrs:{link:""}},["chat"!==this.menu||this.model.uid?t._e():i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.addCardToDeck()}}},[i("q-item-main",{attrs:{label:"Add to Card deck"}})],1),t._v(" "),"chat"!==this.menu||this.model.uid?t._e():i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.addCardToDeckAndBookmark()}}},[i("q-item-main",{attrs:{label:"Add & bookmark"}})],1),t._v(" "),"deck"===this.menu?i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.editCard()}}},[i("q-item-main",{attrs:{label:"Edit"}})],1):t._e(),t._v(" "),"deck"===this.menu?i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.bookmarkCard()}}},[i("q-item-main",{attrs:{label:"Bookmark"}})],1):t._e(),t._v(" "),"deck"===this.menu?i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],on:{click:function(e){t.deleteCard()}}},[i("q-item-main",{attrs:{label:"Delete"}})],1):t._e(),t._v(" "),"bookmark"===this.menu?i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.unbookmarkCard()}}},[i("q-item-main",{attrs:{label:"Remove bookmark"}})],1):t._e(),t._v(" "),"designer"===this.menu?i("q-item",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],nativeOn:{click:function(e){t.forceRefresh()}}},[i("q-item-main",{attrs:{label:"Force refresh"}})],1):t._e()],1)],1)],1)],2)]),t._v(" "),t.model.slots&&t.model.slots.main?i("q-card-main",t._l(t.model.slots.main,function(t){return i(t.component,{key:t,tag:"component",attrs:{model:t}})})):t._e(),t._v(" "),t.model.slots&&t.model.slots.list&&"HbList"===t.model.slots.list[0].component?i("hb-list",{attrs:{model:t.model.slots.list[0]}}):t._e()],1)},D=[];T._withStripped=!0;var M=!1;var L=function(t){M||i("uStN")},E=Object(a.a)(O,T,D,!1,L,null,null);E.options.__file="src\\components\\HbCard.vue";e.a=E.exports},feqG:function(t,e){},nplA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={};i.d(n,"objectSet",function(){return K}),i.d(n,"locationSet",function(){return U}),i.d(n,"itemState",function(){return J});var o={};i.d(o,"updateAll",function(){return Y}),i.d(o,"updateOne",function(){return X}),i.d(o,"setReady",function(){return Z});var a={};i.d(a,"initialLoad",function(){return ot}),i.d(a,"watchEvents",function(){return at}),i.d(a,"sendCmd",function(){return st});var s=i("Dd8w"),r=i.n(s),c=(i("L4dm"),i("hAPP"),i("3Puz"),i("N12Q"),i("/5sW")),l=i("7109"),d=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"q-app"}},[e("router-view")],1)},u=[];d._withStripped=!0;var m=i("XyMi"),h=!1;var p=function(t){h||i("QsxH")},f=Object(m.a)({name:"App"},d,u,!1,p,null,null);f.options.__file="src\\App.vue";var v=f.exports,g=i("/ocq"),b=i("mvHQ"),_=i.n(b),y=i("VRCQ"),q={name:"PageChat",components:{HbCard:y.a},data:function(){return{text:"",chats:[{messages:[],card:!1,finished:!1}],inputAfter:[{icon:"arrow_send",content:!0,handler:this.send}]}},created:function(){var t=this;if(this.$route.redirectedFrom&&0===this.$route.redirectedFrom.indexOf("/notification#")){var e=this.$route.redirectedFrom.replace("/notification#","");this.pushNotificationReceived({data:e})}else this.$http.get("/rest/habot/greet").then(function(e){t.language=e.data.language,t.language||(t.language="en"),t.chats[0].messages.push({id:new Date,name:"HABot",text:[e.data.answer],avatar:"statics/icons/icon-192x192.png",stamp:l.S.formatDate(new Date,"HH:mm")})}).catch(function(e){t.chats[0].messages.push({id:new Date,name:"HABot",text:[_()(e)],avatar:"statics/icons/icon-192x192.png",bgColor:"red",stamp:l.S.formatDate(new Date,"HH:mm")})})},mounted:function(){navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",this.pushNotificationReceived)},methods:{pushNotificationReceived:function(t){var e=this.chats[this.chats.length-1];e.finished&&(this.chats.push({messages:[],card:null,finished:!1}),e=this.chats[this.chats.length-1]),e.messages.push({id:new Date,name:"HABot",text:[t.data],avatar:"statics/icons/icon-192x192.png",stamp:l.S.formatDate(new Date,"HH:mm")})},send:function(){var t=this,e=this.chats[this.chats.length-1];e.messages.push({id:new Date,name:"You",text:[this.text],avatar:"statics/avatar.png",sent:!0,stamp:l.S.formatDate(new Date,"HH:mm")}),this.$http.post("/rest/habot/chat",this.text,{headers:{"Content-Type":"text/plain","Accept-Language":this.language}}).then(function(i){i.data.answer&&e.messages.push({id:new Date,name:"HABot",text:[i.data.answer],avatar:"statics/icons/icon-192x192.png",stamp:l.S.formatDate(new Date,"HH:mm")}),i.data.card&&(e.card=i.data.card,e.finished=!0,t.chats.push({messages:[],card:null,finished:!1})),e.intent=i.data.intent}).catch(function(t){e.messages.push({id:new Date,name:"HABot",text:[_()(t)],avatar:"statics/icons/icon-192x192.png",bgColor:"red",stamp:l.S.formatDate(new Date,"HH:mm")})}),this.text="",this.$q.platform.is.mobile&&this.$refs.input.blur()},keyUp:function(t){13===t.keyCode&&(this.send(),this.$q.platform.is.mobile&&t.currentTarget.blur())},onChatAreaResized:function(t){console.log("Resize: "+_()(t)),this.scrollToBottom()},scrollToBottom:function(){var t=document.getElementById("q-app");t.scrollTop=t.scrollHeight}},beforeDestroyed:function(){this.$q.events.$off("chat-send",this.chatReceived),navigator.serviceWorker&&navigator.serviceWorker.removeEventListener("message",this.pushNotificationReceived)}},w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-page",{staticClass:"row justify-center",attrs:{padding:""}},[i("div",{staticStyle:{width:"600px","margin-top":"100px"}},t._l(t.chats,function(e){return i("div",{key:e,ref:"chat",refInFor:!0,staticClass:"chat-area"},[i("q-resize-observable",{on:{resize:t.onChatAreaResized}}),t._v(" "),i("q-window-resize-observable",{on:{resize:t.scrollToBottom}}),t._v(" "),t._l(e.messages,function(t){return i("q-chat-message",{key:t,attrs:{label:t.label,sent:t.sent,"text-color":t.textColor,"bg-color":t.bgColor,name:t.name,avatar:t.avatar,text:t.text,stamp:t.stamp}})}),t._v(" "),e.card&&"HbCard"===e.card.component?i("hb-card",{attrs:{model:e.card,menu:"chat"}}):t._e(),t._v(" "),e.card&&"HbDumpIntentCard"===e.card.component?i("q-card",[i("q-card-title",[t._v("\n          Intent: "+t._s(e.intent.name)+"\n          "),i("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[t._v("Sorry, this intent is currently unsupported :(")])]),t._v(" "),i("q-list",[i("q-list-header",[t._v("Entities")]),t._v(" "),t._l(e.intent.entities,function(e,n){return i("q-item",{key:e,attrs:{link:"",tag:"label"}},[i("q-item-main",{attrs:{label:n}}),t._v(" "),i("q-item-side",{attrs:{right:""}},[i("big",[t._v(t._s(e))])],1)],1)})],2)],1):t._e()],2)})),t._v(" "),i("q-page-sticky",{staticClass:"chat-input-sticky",attrs:{position:"bottom"}},[i("q-toolbar",{staticClass:"chat-input-toolbar bg-grey-3 shadow-up-3"},[i("q-input",{ref:"input",staticClass:"full-width",attrs:{placeholder:"Ask me about your home",after:t.inputAfter},on:{keyup:t.keyUp},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1)],1)],1)},k=[];w._withStripped=!0;var C=!1;var S=function(t){C||i("feqG")},x=Object(m.a)(q,w,k,!1,S,null,null);x.options.__file="src\\pages\\Chat.vue";var $=x.exports,N=i("BO1k"),A=i.n(N);var H={data:function(){return{speechApi:"google"}},methods:{setGoogleApiKey:function(){var t=this;t.$q.dialog({title:"Set the Google Cloud API key",message:"You need to subscribe to the (paid) Google Cloud Platform to use this feature. There is a trial period and a free tier, which might be enough for casual use. Paste the API key below:",prompt:{model:"",type:"text"},cancel:!0}).then(function(e){t.$q.localStorage.set("habot.googleApiKey",e),t.$q.notify({type:"info",message:"API Key Set for this device"})}).catch(function(){})},enableNotifications:function(){var t=this,e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator?"https:"===window.location.protocol||e?navigator.serviceWorker.getRegistration().then(function(e){return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?(t.$q.notify("Notifications are blocked - please check the browser's site settings"),void t.$q.loading.hide()):"PushManager"in window?void e.pushManager.getSubscription().then(function(i){var n=function(e){t.$q.loading.show({message:"Subscribing to notifications..."}),t.$http.post("/rest/habot/notifications/subscribe",_()(e),{headers:{"Content-Type":"text/plain"}}).then(function(e){t.$q.notify({type:"positive",message:"Success! You should receive a test notification!"}),t.$q.loading.hide()}).catch(function(e){t.$q.notify("Error while sending the subscription to the openHAB server: "+e),t.$q.loading.hide()})};t.$q.loading.show({message:"Initializing, please wait..."}),i?n(i):t.$http.get("/rest/habot/notifications/vapid").then(function(i){var o=function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(e),n=new Uint8Array(i.length),o=0;o<i.length;++o)n[o]=i.charCodeAt(o);return n}(i.data);t.$q.loading.show({message:"Preparing the subscription... Please allow the notifications if prompted!",delay:1e3}),e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o}).then(function(t){n(t)}).catch(function(e){"denied"===Notification.permission?t.$q.notify("Notifications are blocked - please check the browser's site settings"):t.$q.notify("Error while subscribing to push notifications: "+e),t.$q.loading.hide()})}).catch(function(e){t.$q.notify("Error while getting the public VAPID key from the server: "+e),t.$q.loading.hide()})}):(t.$q.notify("Push messaging isn't supported."),void t.$q.loading.hide()):(t.$q.notify("Notifications aren't supported."),void t.$q.loading.hide())}).catch(function(e){t.$q.notify("Error while registering the service worker: "+e)}):t.$q.notify("Sorry, HTTPS is required for the notifications to work"):t.$q.notify("Sorry, notifications are not supported on this browser")},refreshApp:function(){var t=this;this.$q.dialog({title:"Refresh app",message:"This will empty the cache and reload the newest version of the app from the server. You will need to enable push notifications again. Continue?",cancel:!0}).then(function(e){t.$q.loading.show({delay:0,message:"Refreshing the app..."}),setTimeout(function(){navigator.serviceWorker.getRegistrations().then(function(t){var e=!0,i=!1,n=void 0;try{for(var o,a=A()(t);!(e=(o=a.next()).done);e=!0){o.value.unregister()}}catch(t){i=!0,n=t}finally{try{!e&&a.return&&a.return()}finally{if(i)throw n}}location.reload()})},1e3)})}}},Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"layout-padding",staticStyle:{"max-width":"600px"}},[i("br"),t._v(" "),i("q-list",{attrs:{link:""}},[i("q-list-header",[t._v("Speech recognition API")]),t._v(" "),i("q-item",{attrs:{tag:"label"}},[i("q-item-side",[i("q-radio",{attrs:{val:"google"},model:{value:t.speechApi,callback:function(e){t.speechApi=e},expression:"speechApi"}})],1),t._v(" "),i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("Google Cloud Speech")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("Uses Google services, requires an API key.")])],1),t._v(" "),i("q-item-side",{attrs:{right:""}},[i("q-btn",{attrs:{color:"primary",flat:""},on:{click:function(e){t.setGoogleApiKey()}}},[t._v("Setup")])],1)],1),t._v(" "),i("q-item",{attrs:{tag:"label",disabled:""}},[i("q-item-side",[i("q-radio",{attrs:{val:"browser",disable:""},model:{value:t.speechApi,callback:function(e){t.speechApi=e},expression:"speechApi"}})],1),t._v(" "),i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("Browser built-in recognition")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("Uses the browser functionality if supported (not implemented).")])],1)],1),t._v(" "),i("q-item",{attrs:{tag:"label",disabled:""}},[i("q-item-side",[i("q-radio",{attrs:{val:"browser",disable:""},model:{value:t.speechApi,callback:function(e){t.speechApi=e},expression:"speechApi"}})],1),t._v(" "),i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("Send to openHAB speech-to-text")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("Sends the audio to openHAB for local processing (not implemented).")])],1)],1),t._v(" "),i("q-list-header",[t._v("Item tagging")]),t._v(" "),i("q-item",{attrs:{disabled:""}},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("View item tags")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("View and set the tags associated with your items. (todo)")])],1)],1),t._v(" "),i("q-list-header",[t._v("Notifications")]),t._v(" "),i("q-item",{nativeOn:{click:function(e){t.enableNotifications()}}},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("Enable/test push notifications")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("Subscribe to push notifications on this device, and check whether notifications are received.")])],1)],1),t._v(" "),i("q-list-header",[t._v("About")]),t._v(" "),i("q-item",{attrs:{disabled:""}},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("About HABot")])],1)],1),t._v(" "),i("q-item",{nativeOn:{click:function(e){t.refreshApp()}}},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v("Refresh the application")]),t._v(" "),i("q-item-tile",{attrs:{sublabel:""}},[t._v("Empty and refresh the application cache to upgrade the app.")])],1)],1)],1)],1)},O=[];Q._withStripped=!0;var T=Object(m.a)(H,Q,O,!1,null,null,null);T.options.__file="src\\pages\\Settings.vue";var D=T.exports,M={components:{CardDesigner:i("pJtG").default,HbCard:y.a},data:function(){return{objects:[],locations:[],cards:[]}},methods:{addCard:function(){this.$router.push("/designer/"+Object(l.V)())},addListCard:function(){this.$router.push("/designer/"+Object(l.V)()+"?type=list")}},computed:{objectSet:{get:function(){return this.$store.getters["items/objectSet"].map(function(t){return{label:t,value:t}})}},locationSet:{get:function(){return this.$store.getters["items/locationSet"].map(function(t){return{label:t,value:t}})}}},created:function(){var t=this;this.$http.get("/rest/habot/cards").then(function(e){t.cards=e.data})}},L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"row filters bg-grey-2 shadow-2"},[i("q-select",{staticClass:"col-sm-6",attrs:{multiple:"",filter:"",chips:"",color:"secondary",options:t.objectSet,"float-label":"Objects"},model:{value:t.objects,callback:function(e){t.objects=e},expression:"objects"}}),t._v(" "),i("q-select",{staticClass:"col-sm-6",attrs:{multiple:"",filter:"",chips:"",color:"secondary",options:t.locationSet,"float-label":"Locations"},model:{value:t.locations,callback:function(e){t.locations=e},expression:"locations"}})],1),t._v(" "),i("div",{staticClass:"row"},[i("div",{staticClass:"hb-cards"},t._l(t.cards,function(t){return i("HbCard",{key:t.uid,tag:"component",attrs:{model:t,menu:"deck"}})}))]),t._v(" "),i("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[i("q-fab",{attrs:{color:"secondary",icon:"add",direction:"up"}},[i("q-fab-action",{attrs:{color:"secondary",icon:"aspect_ratio"},on:{click:t.addCard}}),t._v(" "),i("q-fab-action",{attrs:{color:"secondary",icon:"list"},on:{click:t.addListCard}})],1)],1)],1)},E=[];L._withStripped=!0;var I=!1;var P=function(t){I||i("TqJv")},j=Object(m.a)(M,L,E,!1,P,null,null);j.options.__file="src\\pages\\CardDeck.vue";var R=[{path:"/",component:function(){return i.e(0).then(i.bind(null,"lfHO"))},children:[{path:"/",redirect:"/chat"},{path:"/chat",component:$},{path:"/settings",component:D},{path:"/cards/deck",component:j.exports},{path:"/notification",redirect:function(t){return{path:"/chat",hash:"",query:"",params:{action:t.hash}}}}]},{path:"/designer/:uid",component:function(){return new Promise(function(t){t()}).then(i.bind(null,"pJtG"))},props:!0},{path:"*",component:function(){return i.e(1).then(i.bind(null,"c5Mg"))}}],B=i("NYxO"),F=i("lHA8"),z=i.n(F),G=i("Gu7T"),V=i.n(G),W=function(t){return[].concat(V()(new z.a(t)))},K=function(t){var e=t.items.map(function(t){return t.tags||[]}).reduce(function(t,e){return t.concat(e)}).filter(function(t){return 0===t.indexOf("object:")}).map(function(t){return t.replace("object:","")});return W(e)},U=function(t){if(!t.items)return[];var e=t.items.map(function(t){return t.tags||[]}).reduce(function(t,e){return t.concat(e)}).filter(function(t){return 0===t.indexOf("location:")}).map(function(t){return t.replace("location:","")});return W(e)},J=function(t){return function(e){if(!t.items)return[];var i=t.items.find(function(t){return t.name===e});return i&&i.state?i.state:null}},Y=function(t,e){console.log("Loaded "+e.length+" items"),t.items=e},X=function(t,e){console.log("Updating "+e.itemName+" state to "+e.newState),t.items.find(function(t){return t.name===e.itemName}).state=e.newState},Z=function(t){t.ready=!0},tt=i("//Fk"),et=i.n(tt),it=i("mtWM"),nt=i.n(it),ot=function(t){return t.state.items.length?et.a.resolve():(console.log("Fetching initial state of all items..."),nt.a.get("/rest/items").then(function(e){return t.commit("updateAll",e.data),t.commit("setReady"),t.dispatch("watchEvents"),et.a.resolve()}))},at=function(t){new EventSource("/rest/events").onmessage=function(e){var i=JSON.parse(e.data);if(i.type.indexOf("ItemStateEvent")>=0){var n=JSON.parse(i.payload),o=i.topic.split("/")[2];t.commit("updateOne",{itemName:o,newState:n.value})}}},st=function(t,e){console.log("Sending command to "+e.itemName+": "+e.command),nt.a.post("/rest/items/"+e.itemName,e.command,{headers:{"Content-Type":"text/plain"}})},rt={namespaced:!0,state:{ready:!1,items:[]},getters:n,mutations:o,actions:a};c.a.use(B.a);var ct=new B.a.Store({modules:{items:rt}});c.a.use(g.a);var lt=new g.a({mode:"hash",base:"/",scrollBehavior:function(){return{y:0}},routes:R});lt.beforeEach(function(t,e,i){ct.dispatch("items/initialLoad").then(function(){return i()})});var dt=lt,ut=i("fH43"),mt=i.n(ut),ht=i("PlbA"),pt=i.n(ht),ft=i("v5o6"),vt=i.n(ft);c.a.config.productionTip=!1,c.a.use(l.T,{components:{QLayout:l.w,QLayoutHeader:l.z,QLayoutFooter:l.y,QLayoutDrawer:l.x,QPageContainer:l.F,QPage:l.E,QPageSticky:l.G,QFab:l.l,QFabAction:l.m,QToolbar:l.N,QToolbarTitle:l.O,QModal:l.C,QModalLayout:l.D,QBtn:l.f,QIcon:l.o,QList:l.A,QListHeader:l.B,QItem:l.q,QItemMain:l.r,QItemSeparator:l.s,QItemSide:l.t,QItemTile:l.u,QField:l.n,QSelect:l.K,QInput:l.p,QChatMessage:l.k,QResizeObservable:l.J,QWindowResizeObservable:l.Q,QCard:l.g,QCardTitle:l.j,QPopover:l.H,QCardMain:l.h,QCardMedia:l.i,QRadio:l.I,QToggle:l.M,QKnob:l.v,QSlider:l.L,QTree:l.P},directives:{Ripple:l.R,CloseOverlay:l.a},plugins:{Notify:l.e,Dialog:l.b,Loading:l.c,LocalStorage:l.d}});var gt=r()({el:"#q-app",router:dt,store:ct},v),bt=[];bt.push(function(t){t.Vue.prototype.$http=nt.a}),bt.push(function(t){t.app,t.router;var e=t.Vue;e.use(pt.a),e.prototype.$jexl=mt.a,e.prototype.$expr=function(t){if(!t.startsWith("="))return t;try{return mt.a.eval(t.substring(1),ct.state.items).then(function(t){return t}).catch(function(t){return t.message})}catch(t){return t}}}),bt.forEach(function(t){return t({app:gt,router:dt,store:ct,Vue:c.a})}),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&window.navigator.standalone&&document.addEventListener("DOMContentLoaded",function(){vt.a.attach(document.body)},!1),new c.a(gt)},pJtG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("BO1k"),o=i.n(n),a=i("VRCQ"),s=i("/5sW");var r={name:"CardDesigner",props:["uid"],components:{HbCard:a.a},data:function(){return{layout:{treepane:!0,toolpane:!0},cardModel:{},treeModel:null,selectedNodeId:"card",newCard:!1}},methods:{goBack:function(){this.$router.push("/cards/deck")},save:function(){var t=this;this.card.uid=this.uid,(this.newCard?this.$http.post("/rest/habot/cards/",this.card):this.$http.put("/rest/habot/cards/"+this.uid,this.card)).then(function(){t.$q.notify({type:"positive",message:"Card saved"})}).catch(function(e){t.$q.notify(e.message)})},redrawCard:function(){this.$refs.card.$forceUpdate()},buildTree:function(){var t=this;this.flattenedComponents={},this.treeModel=null,this.cardModel=null,s.a.nextTick(function(){t.cardModel=t.card,t.treeModel=[function t(e,i){var n={id:i,type:"component",component:e,icon:"widgets",label:e.component};if(e.title&&(n.title=e.title),e.subtitle&&(n.subtitle=e.subtitle),e.config&&(n.config=e.config),e.slots)for(var a in n.children=[],e.slots){var s=i+"-"+a,r={id:s,label:a,component:e,type:"slot",icon:"view_compact",tickable:!1,children:[]},c=0,l=!0,d=!1,u=void 0;try{for(var m,h=o()(e.slots[a]);!(l=(m=h.next()).done);l=!0){var p=m.value;r.children.push(t(p,s+"-"+c++))}}catch(t){d=!0,u=t}finally{try{!l&&h.return&&h.return()}finally{if(d)throw u}}n.children.push(r)}return n}(t.card,"card")]})},addSlot:function(t){var e=this.selectedNode.component;e.slots||(e.slots={}),e.slots[t]=[],this.buildTree()},addComponent:function(t,e){var i=this.selectedNode.component;i.slots[t]||(i.slots[t]=[]),i.slots[t].push({component:e,config:{label:"",item:"",state:"",control:""}}),this.buildTree()}},computed:{selectedNode:function(){if(this.treeModel&&this.selectedNodeId)return function t(e,i){if(e&&i){if(e.id===i)return e;if(e.children){var n=!0,a=!1,s=void 0;try{for(var r,c=o()(e.children);!(n=(r=c.next()).done);n=!0){var l=t(r.value,i);if(l)return l}}catch(t){a=!0,s=t}finally{try{!n&&c.return&&c.return()}finally{if(a)throw s}}return null}}}(this.treeModel[0],this.selectedNodeId)}},created:function(){var t=this;this.$http.get("/rest/habot/cards/"+this.uid).then(function(e){t.card=e.data,t.buildTree()}).catch(function(e){404===e.response.status&&(t.newCard=!0,t.card={title:"New Card",subtitle:"Subtitle",component:"HbCard"},"list"===t.$route.query.type?(t.card.title="New List Card",t.card.slots={list:[{component:"HbList",config:{},slots:{items:[]}}]}):t.card.slots={main:[]},t.buildTree())})}},c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("q-layout",{attrs:{view:"hHh Lpr fFf"}},[i("q-layout-header",[i("q-toolbar",[i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"arrow_back"},on:{click:function(e){t.goBack()}}}),t._v(" "),i("q-toolbar-title",[t._v("\n        Card Designer\n      ")]),t._v(" "),i("q-btn",{attrs:{icon:"save",flat:""},on:{click:function(e){t.save()}}})],1)],1),t._v(" "),i("q-layout-footer",[i("q-toolbar",[i("q-btn",{attrs:{icon:"format_indent_increase",flat:""},on:{click:function(e){t.layout.treepane=!t.layout.treepane}}}),t._v(" "),i("q-toolbar-title"),t._v(" "),i("q-btn",{attrs:{icon:"build",flat:""},on:{click:function(e){t.layout.toolpane=!t.layout.toolpane}}})],1)],1),t._v(" "),i("q-layout-drawer",{attrs:{side:"left","content-class":"bg-grey-2 shadow-1 tree-drawer"},model:{value:t.layout.treepane,callback:function(e){t.$set(t.layout,"treepane",e)},expression:"layout.treepane"}},[i("div",[t.treeModel?i("q-tree",{ref:"tree",staticClass:"designer-tree",attrs:{nodes:t.treeModel,"node-key":"id",selected:t.selectedNodeId,"default-expand-all":""},on:{"update:selected":function(e){t.selectedNodeId=e}}}):t._e()],1)]),t._v(" "),i("q-layout-drawer",{attrs:{side:"right","content-class":"bg-grey-2 shadow-9"},model:{value:t.layout.toolpane,callback:function(e){t.$set(t.layout,"toolpane",e)},expression:"layout.toolpane"}},[t.selectedNode?i("div",{staticClass:"properties"},[i("div",{staticClass:"node-header"},[i("div",{staticClass:"q-title"},[t._v(t._s(t.selectedNode.label))]),t._v(" "),i("div",{staticClass:"q-caption"},[t._v(t._s(t.selectedNode.type))])]),t._v(" "),"component"===t.selectedNode.type?i("div",[t._l(t.selectedNode.config,function(e,n){return i("q-field",{key:n,staticClass:"config-field",attrs:{label:n,orientation:"vertical",helper:"A really really really long help message"}},[i("div",{staticClass:"hidden"},[t._v(t._s(e))]),t._v(" "),i("q-input",{model:{value:t.selectedNode.config[n],callback:function(e){t.$set(t.selectedNode.config,n,e)},expression:"selectedNode.config[prop]"}})],1)}),t._v(" "),i("q-btn",{staticClass:"bg-secondary text-white",on:{click:function(e){t.addSlot("main")}}},[t._v("Add main slot")])],2):t._e(),t._v(" "),"slot"===t.selectedNode.type?i("div",[i("q-btn",{staticClass:"bg-secondary text-white",on:{click:function(e){t.addComponent(t.selectedNode.label,"HbListItem")}}},[t._v("Add list item")]),t._v(" "),i("q-btn",{staticClass:"bg-secondary text-white",on:{click:function(e){t.addComponent(t.selectedNode.label,"HbSlider")}}},[t._v("Add slider")]),t._v(" "),i("q-btn",{staticClass:"bg-secondary text-white",on:{click:function(e){t.addComponent(t.selectedNode.label,"HbKnob")}}},[t._v("Add knob")])],1):t._e()]):t._e()]),t._v(" "),i("div",{staticClass:"fixed-center"},[i("hb-card",{ref:"card",attrs:{model:t.cardModel,menu:"designer"}})],1)],1)},l=[];c._withStripped=!0;var d=i("XyMi"),u=!1;var m=function(t){u||i("KwAo")},h=Object(d.a)(r,c,l,!1,m,null,null);h.options.__file="src\\layouts\\designer\\CardDesigner.vue";e.default=h.exports},uStN:function(t,e){}},[0]);